leg.txt <- c("Original", "Modified")
legend("topleft", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
# Panel B
range(hist0710$area)
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
add_panel_label(ltype = "b")
arrows(res1$max99, 0.6, res1$max99, 0.3, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20)
arrows(res2$max99, 0.6, res2$max99, 0.3, col = "black",
length = 0.1, lwd = 1.5, angle = 20)
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
dev.off()
##### INFORMAL TESTS OF IPM SENSITIVITY #####
paramsWA
res2[1:4] # results of the modified IPM using WA parameters
paramsTest <- paramsWA; paramsTest$surv.slope = 0.5
paramsTest <- paramsWA; paramsTest$surv.int = 3
paramsTest <- paramsWA; paramsTest$growth.slope = 0.5
paramsTest <- paramsWA; paramsTest$growth.int = 0.1
ipmTest <- bigmatrix(n = binN, params = paramsTest)
resTest <- popF(ipmTest, binSize)
resTest[1:4]
dat <- read.csv("./data/bael_growthData.csv", header=TRUE, na.strings="NA")
source("./R/graphicalParams.R")
dat$ini.areaLN <- log(dat$ini.area)
dat$fin.areaLN <- log(dat$fin.area)
datSC <- dat
# Create dataset for SC present
datSCpresent <- datSC[datSC$time == "present", ]
# Create dataset for SC past
datSCpast <- datSC[datSC$time == "past", ]
# Truncate initial size range to reflect the largest observed size in 2007-2010 (1.0 cm2)
set_graph_pars(ptype = "panel1")
plot(fin.area ~ ini.area, data = datSCpast)
points(fin.area ~ ini.area, data = datSCpresent, col = "red")
abline(v = 1.0, col = "black", lty = 3)
abline(a = 0, b = 1, col = "darkgray", lty = 2, lwd = 2)
datSCTrunc <- datSC[datSC$ini.area <= 1.0, ]
##### USE LMER TO TEST THE EFFECT OF ERA ON CORAL GROWTH #####
### Use truncated historical dataset to match observed size range in modern dataset
lmerDat <- datSCTrunc
# Random effects are quadrat (original quadrats for historical study, not subquads)
# Don't need varying slopes by quadrat
Cand.mod <- list()
Cand.mod[[1]] <- lmer(fin.area ~ ini.area * time + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[2]] <- lmer(fin.area ~ ini.area + time + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[3]] <- lmer(fin.area ~ ini.area  + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[4]] <- lmer(fin.area ~ time + (1|quad),
REML = FALSE, data = lmerDat)
Cand.mod[[5]] <- lmer(fin.area ~ 1 + (1|quad),
REML = FALSE, data=lmerDat)
#create a vector of names to trace back models in set
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Size", "Era + Size", "Size", "Era", "Null model")
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text,
sort=TRUE, second.ord=TRUE) # second.ord =TRUE means AICc is used
print(mod.aicctab, digits=2, LL=TRUE)
library(lme4)
library(ggplot2)
theme_set(theme_classic(base_size = 16))
library(AICcmodavg)
library(dplyr)
dat <- read.csv("./data/bael_growthData.csv", header=TRUE, na.strings="NA")
source("./R/graphicalParams.R")
dat$ini.areaLN <- log(dat$ini.area)
dat$fin.areaLN <- log(dat$fin.area)
datSC <- dat
# Create dataset for SC present
datSCpresent <- datSC[datSC$time == "present", ]
# Create dataset for SC past
datSCpast <- datSC[datSC$time == "past", ]
# Truncate initial size range to reflect the largest observed size in 2007-2010 (1.0 cm2)
set_graph_pars(ptype = "panel1")
plot(fin.area ~ ini.area, data = datSCpast)
points(fin.area ~ ini.area, data = datSCpresent, col = "red")
abline(v = 1.0, col = "black", lty = 3)
abline(a = 0, b = 1, col = "darkgray", lty = 2, lwd = 2)
datSCTrunc <- datSC[datSC$ini.area <= 1.0, ]
##### USE LMER TO TEST THE EFFECT OF ERA ON CORAL GROWTH #####
### Use truncated historical dataset to match observed size range in modern dataset
lmerDat <- datSCTrunc
# Random effects are quadrat (original quadrats for historical study, not subquads)
# Don't need varying slopes by quadrat
Cand.mod <- list()
Cand.mod[[1]] <- lmer(fin.area ~ ini.area * time + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[2]] <- lmer(fin.area ~ ini.area + time + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[3]] <- lmer(fin.area ~ ini.area  + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[4]] <- lmer(fin.area ~ time + (1|quad),
REML = FALSE, data = lmerDat)
Cand.mod[[5]] <- lmer(fin.area ~ 1 + (1|quad),
REML = FALSE, data=lmerDat)
#create a vector of names to trace back models in set
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Size", "Era + Size", "Size", "Era", "Null model")
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text,
sort=TRUE, second.ord=TRUE) # second.ord =TRUE means AICc is used
print(mod.aicctab, digits=2, LL=TRUE)
write.csv(mod.aicctab, "./output/growthAIC.csv")
# Save lmerDat as different file
dat_growth <- lmerDat
##### GET MODEL PARAMETERS BY ERA #####
datSCpastTrunc <- datSCpast[datSCpast$ini.area <= 1.0, ]
presMod <- lmer(fin.area ~ ini.area + (1|quad),
REML = FALSE, data = datSCpresent)
pastMod <- lmer(fin.area ~ ini.area + (1|quad),
REML = FALSE, data = datSCpastTrunc)
summary(presMod)
summary(pastMod)
summary(presMod)
summary(presMod)
summary(pastMod)
ylab_growth <- expression(paste("Size at time t+3 (", cm^2, ")"))
xlab_growth <- expression(paste("Size at time t (", cm^2, ")"))
ULClabel <- theme(plot.title = element_text(hjust = -0.15, vjust = 1, size = rel(1.2)))
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.5, 0)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
# labs(title = "B") + ULClabel +
geom_abline(a = 0, b = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
ggsave("./figs/growthPlot.pdf", height = 3.5, width = 3.5)
size1
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
# labs(title = "B") + ULClabel +
sizePlot
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
# labs(title = "B") + ULClabel +
geom_abline(a = 0, b = 1, linetype = 2, color = "black", size = 0.5)
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
# labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
sizePlot
ggsave("./figs/growthPlot.pdf", height = 3.5, width = 3.5)
rm(list=ls(all=TRUE)) # removes all previous material from R's memory
##### LOAD PACKAGES ETC #####
library(grid)
# get sensitivity data
source("./bael_IPM_sensitivity.R")
head(plotDat)
head(plotDat)
# get growth data
source("./bael_growth.R")
head(dat_growth)
# ggplot2 settings
theme_set(theme_classic(base_size = 12))
##### FIGURE - SENSITIVITY ANALYSIS #####
str(plotDat)
# Relevel factors of variable
unique(plotDat$variable)
plotDat$variable <- as.factor(plotDat$variable)
print(levels(plotDat$variable))
plotDat$variable <- with(plotDat, factor(variable, levels(variable)[c(1, 3, 2)]))
ULClabel <- theme(plot.title = element_text(hjust = -0.25, vjust = 1, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
##### FIGURE - GROWTH SCALING BY ERA #####
ylab_growth <- expression(paste("Size at time t+3 (", cm^2, ")"))
xlab_growth <- expression(paste("Size at time t (", cm^2, ")"))
ULClabel <- theme(plot.title = element_text(hjust = -0.15, vjust = 1, size = rel(1.2)))
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.5, -0.05)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(a = 0, b = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
##### MULTI-PANEL PLOT #####
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
##### MULTI-PANEL PLOT #####
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
unique(plotDat$variable)
plotDat$variable <- as.factor(plotDat$variable)
print(levels(plotDat$variable))
plotDat$variable <- with(plotDat, factor(variable, levels(variable)[c(1, 3, 2)]))
print(levels(plotDat$variable))
ULClabel <- theme(plot.title = element_text(hjust = -0.25, vjust = 1, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
##### MULTI-PANEL PLOT #####
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
ULClabel <- theme(plot.title = element_text(hjust = -0.25, vjust = 0, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
ULClabel <- theme(plot.title = element_text(hjust = 0, vjust = 0, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 0, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
ULClabel <- theme(plot.title = element_text(hjust = -0.15, vjust = 1, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
##### FIGURE - GROWTH SCALING BY ERA #####
ylab_growth <- expression(paste("Size at time t+3 (", cm^2, ")"))
xlab_growth <- expression(paste("Size at time t (", cm^2, ")"))
ULClabel <- theme(plot.title = element_text(hjust = -0.15, vjust = 1, size = rel(1.2)))
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.5, -0.05)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
##### MULTI-PANEL PLOT #####
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 1, size = rel(1.2)))
sensitivityPlot <- ggplot(plotDat, aes(param, value)) +
geom_bar(stat = "identity", color = "black", fill = "darkgray") +
geom_hline(yintercept = c(0, 10), color = "gray", linetype = "dashed") +
# geom_hline(yintercept = 10, lty = 2, color = "darkgray") +
theme(legend.justification = c(1, 1), legend.position = c(0.95, 0.95)) +
scale_fill_discrete(name = "Perturbation") +
ylab("Percentage change") + xlab("Parameter") +
scale_x_discrete(limits = rev(paramOrder), labels = rev(paramLabels)) +
theme(strip.background = element_blank()) +
# scale_y_continuous(limits = c(-5, 35)) +
theme(axis.text.y = element_text(size = 8)) +
facet_wrap(~ variable) + coord_flip() +
labs(title = "A") + ULClabel +
theme(panel.margin = unit(1.5, "lines"))
sensitivityPlot
##### MULTI-PANEL PLOT #####
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.5, 0.05)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.45, 0.03)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
##### MULTI-PANEL PLOT #####
pdf("./figs/sensitivityGrowthPlot.pdf", width = 9, height = 3.5)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
dev.off()
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 1, 2), nrow = 1, byrow = TRUE))
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 2), nrow = 2, byrow = TRUE))
pdf("./figs/sensitivityGrowthPlot_2rows.pdf", width = 7, height = 7)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 2), nrow = 2, byrow = TRUE))
dev.off()
pdf("./figs/sensitivityGrowthPlot_2rows.pdf", width = 5, height = 7)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 2), nrow = 2, byrow = TRUE))
dev.off()
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.5, 0.03)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
pdf("./figs/sensitivityGrowthPlot_2rows.pdf", width = 5, height = 7)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 2), nrow = 2, byrow = TRUE))
dev.off()
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.65, 0.03)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
pdf("./figs/sensitivityGrowthPlot_2rows.pdf", width = 5, height = 7)
multiplot(sensitivityPlot, sizePlot,
layout = matrix(c(1, 2), nrow = 2, byrow = TRUE))
dev.off()
size1 <- ggplot(dat_growth, aes(ini.area, fin.area, color = time, shape = time)) +
ylab(ylab_growth) + xlab(xlab_growth) +
theme(legend.justification = c(0, 0), legend.position = c(0.5, 0)) +
theme(legend.title = element_blank()) +
geom_point(size = 2.5, alpha = 0.6,
position = position_jitter(h = 0.05)) +
scale_colour_manual(breaks = c("past", "present"),
values = c("darkgray", "black"),
labels = c("1969-1972", "2007-2010")) +
scale_shape_manual(breaks = c("past", "present"),
values = c(18, 20),
labels = c("1969-1972", "2007-2010"))
sizePlot <- size1 +
geom_smooth(method = "lm", se = FALSE, size = 0.75) +
# labs(title = "B") + ULClabel +
geom_abline(intercept = 0, slope = 1, linetype = 2, color = "black", size = 0.5)
sizePlot
ggsave("./figs/growthPlot.pdf", height = 3.5, width = 3.5)
library(lmerModelTest)
library(lmerTest)
Cand.mod[[1]] <- lmer(fin.area ~ ini.area * time + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[2]] <- lmer(fin.area ~ ini.area + time + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[3]] <- lmer(fin.area ~ ini.area  + (1|quad),
REML = FALSE, data=lmerDat)
Cand.mod[[4]] <- lmer(fin.area ~ time + (1|quad),
REML = FALSE, data = lmerDat)
Cand.mod[[5]] <- lmer(fin.area ~ 1 + (1|quad),
REML = FALSE, data=lmerDat)
#create a vector of names to trace back models in set
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Size", "Era + Size", "Size", "Era", "Null model")
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text,
sort=TRUE, second.ord=TRUE) # second.ord =TRUE means AICc is used
print(mod.aicctab, digits=2, LL=TRUE)
write.csv(mod.aicctab, "./output/growthAIC.csv")
summary(Cand.mod[[1]])
0.1/0.78
