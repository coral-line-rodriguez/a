#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
segments(res2$max95, 0.3, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 2)
segments(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 2)
segments(res2$max99, 0.4, res2$max99, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 2)
segments(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, -0.1, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 2)
segments(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, -0.1, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 2)
pdf("./figs/ipm_histo_fit.pdf", 7, 3.5)
set_graph_pars(ptype = "panel2")
xlab2 <- expression(paste("Size (", cm^2, ")"))
#### Panel A ####
plot(mx.coral ~ areaR, data = ltDat, xlim = c(0, 1.5), ylim = c(-0.025, 40),
xlab = xlab2, ylab = "Embryo number", las = 1, type = "n")
add_panel_label(ltype = "a")
# for(i in 1:N){
#   curve(slopeCA * x +
#           data_in$embryo.int[i], from = 0, to = 1.4, add = TRUE,
#         col = vec_colors[i], lwd = 1)
# }
# abline(mxRegWA, lwd=2, lty=1, col = "darkgray")
abline(mxRegCA, lwd=2, lty=1)
abline(a = 0, b = 0, lty=3, lwd=2, col="darkgray")
points(mx.coral ~ areaR, data = ltDat)
curve(slopeCA * x + data_in$embryo.int[medianEa_position],
from = 0, to = 1.5, add = TRUE,
col = "darkgray", lwd = 2)
add_panel_label(ltype = "a")
#### Panel B ####
quantile(hist0710$area, probs = c(0.95, 0.99))
obs99 <- quantile(hist0710$area, probs = 0.99)
# hist(hist0710$area, breaks = seq(0.02, 1.5, 0.02), freq = FALSE,
#      xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
segments(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 2, angle = 20, lty = 2)
segments(res2$max99, 0.4, res2$max99, -0.1, col = "black",
length = 0.1, lwd = 2, angle = 20, lty = 2)
segments(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, -0.1, col = "darkgray",
length = 0.1, lwd = 2, angle = 20, lty = 2)
segments(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, -0.1, col = "darkgray",
length = 0.1, lwd = 2, angle = 20, lty = 2)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
dev.off()
######
arrows(res_out[[medianEa_position]]$max95, -0.2,
res_out[[medianEa_position]]$max95, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res2$max99, -0.2, res2$max99, 0, col = "black",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, -0.2,
res_out[[medianEa_position]]$max99, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
##### PLOTTING #####
pdf("./figs/ipm_histo_fit.pdf", 7, 3.5)
set_graph_pars(ptype = "panel2")
xlab2 <- expression(paste("Size (", cm^2, ")"))
#### Panel A ####
plot(mx.coral ~ areaR, data = ltDat, xlim = c(0, 1.5), ylim = c(-0.025, 40),
xlab = xlab2, ylab = "Embryo number", las = 1, type = "n")
add_panel_label(ltype = "a")
# for(i in 1:N){
#   curve(slopeCA * x +
#           data_in$embryo.int[i], from = 0, to = 1.4, add = TRUE,
#         col = vec_colors[i], lwd = 1)
# }
# abline(mxRegWA, lwd=2, lty=1, col = "darkgray")
abline(mxRegCA, lwd=2, lty=1)
abline(a = 0, b = 0, lty=3, lwd=2, col="darkgray")
points(mx.coral ~ areaR, data = ltDat)
curve(slopeCA * x + data_in$embryo.int[medianEa_position],
from = 0, to = 1.5, add = TRUE,
col = "darkgray", lwd = 2)
add_panel_label(ltype = "a")
legend("bottomright", "n = 12", cex = 1.1, bty = "n", adj = c(0,-2))
leg.txt <- c("Original", "Modified")
legend("topleft", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
#### Panel B ####
quantile(hist0710$area, probs = c(0.95, 0.99))
obs99 <- quantile(hist0710$area, probs = 0.99)
# hist(hist0710$area, breaks = seq(0.02, 1.5, 0.02), freq = FALSE,
#      xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
segments(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 2, angle = 20, lty = 2)
segments(res2$max99, 0.4, res2$max99, -0.1, col = "black",
length = 0.1, lwd = 2, angle = 20, lty = 2)
segments(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, -0.1, col = "darkgray",
length = 0.1, lwd = 2, angle = 20, lty = 2)
segments(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, -0.1, col = "darkgray",
length = 0.1, lwd = 2, angle = 20, lty = 2)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
dev.off()
######
arrows(res_out[[medianEa_position]]$max95, -0.2,
res_out[[medianEa_position]]$max95, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res2$max99, -0.2, res2$max99, 0, col = "black",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, -0.2,
res_out[[medianEa_position]]$max99, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
##### PLOTTING #####
pdf("./figs/ipm_histo_fit.pdf", 7, 3.5)
set_graph_pars(ptype = "panel2")
xlab2 <- expression(paste("Size (", cm^2, ")"))
#### Panel A ####
plot(mx.coral ~ areaR, data = ltDat, xlim = c(0, 1.5), ylim = c(-0.025, 40),
xlab = xlab2, ylab = "Embryo number", las = 1, type = "n")
add_panel_label(ltype = "a")
# for(i in 1:N){
#   curve(slopeCA * x +
#           data_in$embryo.int[i], from = 0, to = 1.4, add = TRUE,
#         col = vec_colors[i], lwd = 1)
# }
# abline(mxRegWA, lwd=2, lty=1, col = "darkgray")
abline(mxRegCA, lwd=2, lty=1)
abline(a = 0, b = 0, lty=3, lwd=2, col="darkgray")
points(mx.coral ~ areaR, data = ltDat)
curve(slopeCA * x + data_in$embryo.int[medianEa_position],
from = 0, to = 1.5, add = TRUE,
col = "darkgray", lwd = 2)
add_panel_label(ltype = "a")
legend("bottomright", "n = 12", cex = 1.1, bty = "n", adj = c(0,-2))
leg.txt <- c("Original", "Modified")
legend("topleft", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
#### Panel B ####
quantile(hist0710$area, probs = c(0.95, 0.99))
obs99 <- quantile(hist0710$area, probs = 0.99)
# hist(hist0710$area, breaks = seq(0.02, 1.5, 0.02), freq = FALSE,
#      xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
segments(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 2, angle = 20, lty = 1)
segments(res2$max99, 0.4, res2$max99, -0.1, col = "black",
length = 0.1, lwd = 2, angle = 20, lty = 1)
segments(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, -0.1, col = "darkgray",
length = 0.1, lwd = 2, angle = 20, lty = 1)
segments(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, -0.1, col = "darkgray",
length = 0.1, lwd = 2, angle = 20, lty = 1)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
dev.off()
######
arrows(res_out[[medianEa_position]]$max95, -0.2,
res_out[[medianEa_position]]$max95, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res2$max99, -0.2, res2$max99, 0, col = "black",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, -0.2,
res_out[[medianEa_position]]$max99, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
##### PLOTTING #####
pdf("./figs/ipm_histo_fit.pdf", 7, 3.5)
set_graph_pars(ptype = "panel2")
xlab2 <- expression(paste("Size (", cm^2, ")"))
#### Panel A ####
plot(mx.coral ~ areaR, data = ltDat, xlim = c(0, 1.5), ylim = c(-0.025, 40),
xlab = xlab2, ylab = "Embryo number", las = 1, type = "n")
add_panel_label(ltype = "a")
# for(i in 1:N){
#   curve(slopeCA * x +
#           data_in$embryo.int[i], from = 0, to = 1.4, add = TRUE,
#         col = vec_colors[i], lwd = 1)
# }
# abline(mxRegWA, lwd=2, lty=1, col = "darkgray")
abline(mxRegCA, lwd=2, lty=1)
abline(a = 0, b = 0, lty=3, lwd=2, col="darkgray")
points(mx.coral ~ areaR, data = ltDat)
curve(slopeCA * x + data_in$embryo.int[medianEa_position],
from = 0, to = 1.5, add = TRUE,
col = "darkgray", lwd = 2)
add_panel_label(ltype = "a")
legend("bottomright", "n = 12", cex = 1.1, bty = "n", adj = c(0,-2))
leg.txt <- c("Original", "Modified")
legend("topleft", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
#### Panel B ####
quantile(hist0710$area, probs = c(0.95, 0.99))
obs99 <- quantile(hist0710$area, probs = 0.99)
# hist(hist0710$area, breaks = seq(0.02, 1.5, 0.02), freq = FALSE,
#      xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
segments(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
segments(res2$max99, 0.4, res2$max99, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
segments(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, -0.1, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
segments(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, -0.1, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
dev.off()
######
arrows(res_out[[medianEa_position]]$max95, -0.2,
res_out[[medianEa_position]]$max95, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res2$max99, -0.2, res2$max99, 0, col = "black",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, -0.2,
res_out[[medianEa_position]]$max99, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
quantile(hist0710$area, probs = c(0.95, 0.99))
obs99 <- quantile(hist0710$area, probs = 0.99)
# hist(hist0710$area, breaks = seq(0.02, 1.5, 0.02), freq = FALSE,
#      xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
segments(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
segments(res2$max99, 0.4, res2$max99, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
segments(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, -0.1, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
segments(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, -0.1, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
arrows(res2$max95, 0.4, res2$max95, -0.1, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res2$max95, 0.4, res2$max95, 0, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res2$max95, 0.4, res2$max95, 0.05, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
arrows(res2$max95, 0.4, res2$max95, 0.05, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res2$max99, 0.4, res2$max99, 0.05, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, 0.05, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, 0.05, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
##### PLOTTING #####
pdf("./figs/ipm_histo_fit.pdf", 7, 3.5)
set_graph_pars(ptype = "panel2")
xlab2 <- expression(paste("Size (", cm^2, ")"))
#### Panel A ####
plot(mx.coral ~ areaR, data = ltDat, xlim = c(0, 1.5), ylim = c(-0.025, 40),
xlab = xlab2, ylab = "Embryo number", las = 1, type = "n")
add_panel_label(ltype = "a")
# for(i in 1:N){
#   curve(slopeCA * x +
#           data_in$embryo.int[i], from = 0, to = 1.4, add = TRUE,
#         col = vec_colors[i], lwd = 1)
# }
# abline(mxRegWA, lwd=2, lty=1, col = "darkgray")
abline(mxRegCA, lwd=2, lty=1)
abline(a = 0, b = 0, lty=3, lwd=2, col="darkgray")
points(mx.coral ~ areaR, data = ltDat)
curve(slopeCA * x + data_in$embryo.int[medianEa_position],
from = 0, to = 1.5, add = TRUE,
col = "darkgray", lwd = 2)
add_panel_label(ltype = "a")
legend("bottomright", "n = 12", cex = 1.1, bty = "n", adj = c(0,-2))
leg.txt <- c("Original", "Modified")
legend("topleft", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
#### Panel B ####
quantile(hist0710$area, probs = c(0.95, 0.99))
obs99 <- quantile(hist0710$area, probs = 0.99)
# hist(hist0710$area, breaks = seq(0.02, 1.5, 0.02), freq = FALSE,
#      xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
#      ylim = c(-0.025, 2.5), xlim = c(0, 1.5), border = "gray90", las = 1)
# Used larger bins to reduce noise
hist(hist0710$area, breaks = seq(0.0, 1.5, 0.05), freq = FALSE,
xlab = xlab2, ylab="Probability density", col = "gray87", main = "",
ylim = c(-0.025, 2), xlim = c(0, 1.4), border = "gray90", las = 1)
box()
# for(i in 1:N){
#   points(ipm_out[[i]]$meshpts , res_out[[i]]$ssd2, type="l", lty=1, lwd = 1,
#          col = vec_colors[i])
# }
# # Ea = 0.65
# points(ipm1$meshpts , res1$ssd2, type="l", lty=1, lwd = 2,
#        col = "darkgray")
# California parameters
points(ipm2$meshpts , res2$ssd2, type="l", lty=1, lwd = 2,
col = "black")
# Optimized Ea = 0.658
points(ipm_out[[medianEa_position]]$meshpts ,
res_out[[medianEa_position]]$ssd2, type="l", lty=1, lwd = 2,
col = "darkgray")
# arrows(res1$max95, 0.6, res1$max95, 0.3, col = "darkgray",
#        length = 0.1, lwd = 1.5, angle = 20)
arrows(res2$max95, 0.4, res2$max95, 0.05, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res2$max99, 0.4, res2$max99, 0.05, col = "black",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max95, 0.4,
res_out[[medianEa_position]]$max95, 0.05, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, 0.4,
res_out[[medianEa_position]]$max99, 0.05, col = "darkgray",
length = 0.1, lwd = 1, angle = 20, lty = 1)
points(obs99, 0, pch = 21, col = "darkgray", lwd = 2)
res_out[[medianEa_position]]$max99
res_out[[medianEa_position]]$max95
add_panel_label(ltype = "b")
legend("topright", leg.txt, lwd = 2, bty = "n",
col = c("black", "darkgray"), lty = 1,
cex = 1, text.col = c("black", "darkgray"))
dev.off()
######
arrows(res_out[[medianEa_position]]$max95, -0.2,
res_out[[medianEa_position]]$max95, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res2$max99, -0.2, res2$max99, 0, col = "black",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
arrows(res_out[[medianEa_position]]$max99, -0.2,
res_out[[medianEa_position]]$max99, 0, col = "darkgray",
length = 0.1, lwd = 1.5, angle = 20, lty = 1)
