##########################################################
##########################################################
# lme4
# test whether survival is differrent among eras
lmerDat <- dat[dat$ini.area < 0.96, ]
#lmerDat <- datSC
dim(lmerDat)
unique(lmerDat$quad)
Cand.mod <- list()
Cand.mod[[1]] <- glmer(survival ~ ini.area*time + (1|quad),
data = lmerDat, family = binomial)
Cand.mod[[2]] <- glmer(survival ~ ini.area + time + (1|quad),
data = lmerDat, family = binomial)
Cand.mod[[3]] <- glmer(survival ~ ini.area + (1|quad),
data = lmerDat, family = binomial)
Cand.mod[[4]] <- glmer(survival ~ time + (1|quad),
data = lmerDat, family = binomial)
Cand.mod[[5]] <- glmer(survival ~ 1 + (1|quad),
data = lmerDat, family = binomial)
#generate AICc table with names
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Size", "Era + Size", "Size", "Era", "Null model")
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text,
sort=TRUE, second.ord=TRUE) # second.ord =TRUE means AICc is used
print(mod.aicctab, digits=2, LL=TRUE)
write.csv(mod.aicctab, "./output/survivalAIC.csv")
summary(Cand.mod[[1]])
# check normality and homogeneity of variances
globalMod <- Cand.mod[[1]] #
# check normality and homogeneity of variances
par(mfrow = c(1,2))
qqnorm(resid(globalMod))
qqline(resid(globalMod))
plot(resid(globalMod) ~ fitted(globalMod)); abline(h=0)
summary(globalMod)
fitted(globalMod)
# tables of estimates with 95% CI
se <- sqrt(diag(vcov(globalMod)))
tab <- cbind(Est = fixef(globalMod),
LL = fixef(globalMod)  - 1.96 * se,
UL = fixef(globalMod) + 1.96 * se)
tab
# odds ratios, by exponentiation
exp(tab)
# caterpillar plot
ranef(globalMod, which = "quad", condVar = TRUE)
library(sjPlot)
sjp.lmer(globalMod)
sjp.lmer(globalMod, type = "fe.cor")
sjp.lmer(globalMod, type = "re.qq")
sjp.lmer(globalMod, fade.ns = TRUE, free.scale = TRUE,
geom.colors = c(1,1), showValueLabels = FALSE,
sort.coef = TRUE)
sjp.lmer(globalMod, fade.ns = TRUE, free.scale = TRUE,
geom.colors = c(1,1), showValueLabels = FALSE,
type = "fe")
##########################################################
##########################################################
# COMPARE PARAMETERS
##########################################################
##########################################################
glm1 <- glm(survival ~ ini.area*time, data = lmerDat, family = binomial)
summary(glm1)
head(dat)
datPres <- lmerDat[lmerDat$time == "present", ]
datPast <- lmerDat[lmerDat$time == "past", ]
pastMod <- glmer(survival ~ ini.area + (1|quad),
data = datPast, family = binomial)
presMod <- glmer(survival ~ ini.area + (1|quad),
data = datPres, family = binomial)
pastMod2 <- glm(survival ~ ini.area,
data = datPast, family = binomial)
presMod2 <- glm(survival ~ ini.area,
data = datPres, family = binomial)
summary(pastMod)
summary(pastMod2)
summary(presMod)
summary(presMod2)
summary(pastMod)
summary(presMod)
curve(plogis(0.5186 + 3.4766*x), ylim = c(0,1), lwd = 2, col = "darkgray")
curve(plogis(1.7106 + 0.4489*x), lwd = 2, col = 1, add = TRUE)
curve(plogis(0.5186 + 0.4489*x), ylim = c(0,1), lwd = 2, col = "red", add = TRUE)
curve(plogis(1.7106 + 3.4766*x), ylim = c(0,1), lwd = 2, col = "blue", add = TRUE)
summary(pastMod)
library(dplyr)
library(ggplot2)
theme_set(theme_bw(base_size=12))
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
head(hms_corr)
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
str(hms_corr)
dat2 <- hms_corr %>% select(dateR, new) %>% rename(SST = new)
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
head(hms_corr)
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
str(hms_corr)
hms <- hms_corr %>% select(dateR, new) %>% rename(SST = new)
# get month and year to calculate averages
hms$month <- strftime(hms$dateR, "%m")
hms$year <- strftime(hms$dateR, "%Y")
hms$mo_yr <- with(hms, paste(month, year, sep = "_"))
hms$SST <- as.numeric(hms$SST)
str(hms)
fadTemp <- filter(hms, year > 1968 & year < 1978)
fadTempt
fadTemp
head(fadTemp)
---------------
rr <- read.table("./data/racerockday.txt",
header=FALSE, na.strings="99.9", skip = 3)
head(rr)
names(rr) <- c("year", "month", "day", "salinity", "tempC")
rr$dateR <- with(rr, as.Date(ISOdate(year, month, day)))
qplot(dateR, tempC, data = rr[rr$year > 1960, ])
rr$julien <- as.numeric(format(rr$dateR, "%j"))
summary(rr)
str(rr)
qplot(julien, tempC, data = rr, color = year)
qplot(julien, tempC, data = rr, color = year, alpha = 0.5)
sc <- read.csv("./data/SC_temp daily means.csv",
header=TRUE)
head(sc)
sc$dateR <- with(sc, as.Date(sc$date, "%m/%d/%y"))
sc$year <- as.numeric(format(sc$dateR, "%Y"))
sc$month <- as.numeric(format(sc$dateR, "%m"))
sc$day <- as.numeric(format(sc$dateR, "%d"))
sc$julien <- as.numeric(format(sc$dateR, "%j"))
glimpse(sc)
glimpse(rr)
corrDat <- inner_join(rr, sc, by = "dateR")
dim(corrDat)
head(corrDat)
qplot(tempC, temp.mean, data = corrDat)
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point()
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point() + geom_smooth(method = "linear")
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point() + geom_smooth(method = "lm")
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point() + geom_smooth(method = "lm") +
geom_abline(intercept = 0, slope = 1)
head(rr)
head(sc)
lm1 <- lm(temp.mean ~ tempC, data = corrDat)
summary(lm1)
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm") +
geom_abline(intercept = 0, slope = 1, color = "red")
with(corrDat, sd(temp.mean))
with(corrDat, sd(temp.mean, na.rm = TRUE))
with(corrDat, sd(tempC, na.rm = TRUE))
lm1 <- lm(temp.mean ~ tempC, data = corrDat)
summary(lm1)
# Now use regression to predict SC temperatures for 10-year chunks
# 1962-1972, 2000-2010
dim(rr)
rr$tempSC <- 1.3976 + 0.8105 * rr$tempC
tail(rr)
head(corrDat)
ggplot(data = corrDat, aes(temp.mean, tempC)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm") +
geom_abline(intercept = 0, slope = 1, color = "red")
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm") +
geom_abline(intercept = 0, slope = 1, color = "red") +
xlab("Race Rocks temperature") +
ylab("Shady Cove temperature")
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm", width = 2) +
geom_abline(intercept = 0, slope = 1, color = "red") +
xlab("Race Rocks temperature") +
ylab("Shady Cove temperature")
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm", lwd = 2) +
geom_abline(intercept = 0, slope = 1, color = "red") +
xlab("Race Rocks temperature") +
ylab("Shady Cove temperature")
### Examine correlation between two sites ###
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm") +
geom_abline(intercept = 0, slope = 1, color = "red", lwd = 1.5) +
xlab("Race Rocks temperature") +
ylab("Shady Cove temperature")
### Examine correlation between two sites ###
ggplot(data = corrDat, aes(tempC, temp.mean)) +
geom_point(alpha = 0.5) + geom_smooth(method = "lm") +
geom_abline(intercept = 0, slope = 1, color = "red", lwd = 1.5, lty = 2) +
xlab("Race Rocks temperature") +
ylab("Shady Cove temperature")
summary(lm1)
# Calculate monthly averages for Race Rocks temperature
rrDataM <- rr %>% group_by(year, month) %>%
summarise(monthC = mean(tempC)) %>%
ungroup()
rrDataM
historicRR <- rrDataM %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE))
modernRR <- rrDataM %>% filter(year > 2000 & year < 2010) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE))
historicRR; modernRR # 8.9, 9.7
# now translate these averages to predicted SC values
1.3976 + 0.8105*historicRR
1.3976 + 0.8105*modernRR
# 8.6, 9.2
# Calculate monthly averages for predicted SC temperature
dim(rr)
rrM <- rr %>% group_by(year, month) %>%
summarise(monthC = mean(tempSC)) %>%
ungroup()
rrM
histC <- rrM %>% filter(year > 1962 & year < 1972)
qplot(dateR, monthC, data = histC)
rrM %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE),
sd = sd(monthC, na.rm = TRUE))
# 8.6C
modC <- rrM %>% filter(year > 2000 & year < 2010)
qplot(dateR, monthC, data = modC)
rrM %>% filter(year > 2000 & year < 2010) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE),
sd = sd(monthC, na.rm = TRUE))
# 9.25 C
glimpse(sc)
qplot(dateR, temp.mean, data = sc)
scM <- sc %>% group_by(year, month) %>%
summarise(monthC = mean(temp.mean, na.rm = TRUE)) %>%
ungroup()
scM
scM$dateR <- with(scM, ISOdate(year, month, day = 15))
qplot(dateR, monthC, data = scM, geom = "line")
scM %>% filter(year < 2011) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE))
tail(rr)
# calculate average temps for SC estimate
rr %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE))
rr %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 2000 & year < 2010) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 1964 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 1967 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 2005 & year < 2010) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 1964 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
rr %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
pastSC <- rr %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
presSC <- rr %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
pastSC, presSC
pastSC; presSC
sc_monthly <- rr %>% group_by(year, month) %>%
summarise(monthC = mean(tempSC)) %>%
ungroup()
head(sc_monthly)
pastSC_monthly <- sc_monthly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
pastSC_monthly <- sc_monthly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE),
sdTemp = sd(monthC, na.rm = TRUE))
presSC_monthly <- sc_monthly %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE),
sdTemp = sd(monthC, na.rm = TRUE))
pastSC_monthly; presSC_monthly
sc_yearly <- rr %>% group_by(year) %>%
summarise(yearC = mean(tempSC)) %>%
ungroup()
head(sc_yearly)
sc_yearly <- rr %>% group_by(year) %>%
summarise(tempC = mean(tempSC)) %>%
ungroup()
head(sc_yearly)
sc_yearly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
sc_yearly %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
pastSC_monthly; presSC_monthly
sc_yearly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
sc_yearly %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
head(sc_yearly)
sc_yearly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
sc_yearly %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
sc_yearly <- rr %>% group_by(year) %>%
summarise(tempC = mean(tempSC, na.rm = TRUE)) %>%
ungroup()
head(sc_yearly)
summary(rr)
sc_monthly <- rr %>% group_by(year, month) %>%
summarise(monthC = mean(tempSC, na.rm = TRUE)) %>%
ungroup()
head(sc_monthly)
pastSC_monthly <- sc_monthly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE),
sdTemp = sd(monthC, na.rm = TRUE))
presSC_monthly <- sc_monthly %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE),
sdTemp = sd(monthC, na.rm = TRUE))
pastSC_monthly; presSC_monthly
# Calculate annual averages for predicted SC temperature
sc_yearly <- rr %>% group_by(year) %>%
summarise(tempC = mean(tempSC, na.rm = TRUE)) %>%
ungroup()
head(sc_yearly)
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(year, tempC, geom = "point")
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(year, tempC)
sc_yearly %>% filter(year > 1962 & year < 2010)
?qplot
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .)
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .) %>% geom_smooth()
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .) + geom_smooth()
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .) + geom_smooth() +
geom_smooth(method = "lm")
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .)
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .) + geom_smooth()
sc_monthly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .) + geom_smooth()
sc_monthly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = monthSC, data = .) + geom_smooth()
sc_monthly <- rr %>% group_by(year, month) %>%
summarise(monthC = mean(tempSC, na.rm = TRUE)) %>%
ungroup()
head(sc_monthly)
sc_monthly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = monthC, data = .) + geom_smooth()
sc_monthly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = monthC, data = ., geom = "line") + geom_smooth()
sc_monthly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = monthC, data = .) + geom_smooth()
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
qplot(x = year, y = tempC, data = .) + geom_smooth()
pastSC <- rr %>% filter(year > 1962 & year < 1972)
presSC <- rr %>% filter(year > 2002 & year < 2010)
pastSC <- rr %>% filter(year > 1962 & year < 1972)
presSC <- rr %>% filter(year > 2002 & year < 2010)
pastSC %>% summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
presSC %>% summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
head(pastSC)
pastSC$era <- "1962-1972"
pastSC$era <- "1962-1972"
presSC$era <- "2000-2010"
longSC <- rbind(pastSC, presSC)
ggplot(data = longSC, aes(era, tempSC)) + geom_boxplot()
ggplot(data = longSC, aes(era, tempSC)) + geom_boxplot(notch = TRUE)
ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily minimum temperature (", degree, "C)")))
ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily temperature (", degree, "C)"))) +
xlab("")
plot_temp_boxplot <- ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily temperature (", degree, "C)"))) +
xlab("")
theme_set(theme_classic(base_size=12))
ULClabel <- theme(plot.title = element_text(hjust = -0.05, vjust = 1,
size = rel(1.2)))
ULClabel <- theme(plot.title = element_text(hjust = -0.05, vjust = 1,
size = rel(1.2)))
### Daily temperatures - era comparison
plot_temp_boxplot <- ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily temperature (", degree, "C)"))) +
xlab("") +
ULClabel + labs(title = "B")
ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily temperature (", degree, "C)"))) +
xlab("") +
ULClabel + labs(title = "B")
sc_yearly %>% filter(year > 1962 & year < 1972) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
sc_yearly %>% filter(year > 2002 & year < 2010) %>%
summarise(meanTemp = mean(tempC, na.rm = TRUE),
sdTemp = sd(tempC, na.rm = TRUE))
histC <- rrM %>% filter(year > 1962 & year < 1972)
qplot(dateR, monthC, data = histC)
glimpse(sc)
qplot(dateR, temp.mean, data = sc)
scM <- sc %>% group_by(year, month) %>%
summarise(monthC = mean(temp.mean, na.rm = TRUE)) %>%
ungroup()
scM
scM$dateR <- with(scM, ISOdate(year, month, day = 15))
qplot(dateR, monthC, data = scM, geom = "line")
scM %>% filter(year < 2011) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE))
scM %>% filter(year > 2007 & year < 2011) %>%
summarise(meanTemp = mean(monthC, na.rm = TRUE))
head(rr)
tail(rr)
glimpse(sc)
sc %>% filter(year > 2007 & year < 2011) %>%
summarise(tempC = mean(monthC, na.rm = TRUE))
sc %>% filter(year > 2007 & year < 2011) %>%
summarise(tempC = mean(tempC, na.rm = TRUE))
sc %>% filter(year > 2007 & year < 2011) %>%
summarise(tempC = mean(temp.mean, na.rm = TRUE))
rr %>% filter(year > 2007 & year < 2011) %>%
summarise(tempC = mean(tempSC, na.rm = TRUE))
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
ggplot(data = ., aes(year, tempC)) + geom_smooth()
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
ggplot(data = ., aes(year, tempC)) +
geom_point() + geom_smooth()
sc_yearly %>% filter(year > 1962 & year < 2010) %>%
ggplot(data = ., aes(year, tempC)) +
geom_point() + geom_smooth() +
ylab(expression(paste("Annual temperature (", degree, "C)"))) +
xlab("") +
ULClabel + labs(title = "A")
### Annual temperatures - time-series
plot_temp_annual <- sc_yearly %>% filter(year > 1962 & year < 2010) %>%
ggplot(data = ., aes(year, tempC)) +
geom_point() + geom_smooth() +
ylab(expression(paste("Annual temperature (", degree, "C)"))) +
xlab("Year") +
ULClabel + labs(title = "A")
### Daily temperatures - era comparison
plot_temp_daily <- ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily temperature (", degree, "C)"))) +
xlab("") +
ULClabel + labs(title = "B")
multiplot(plot_temp_daily, plot_temp_annual, cols = 2)
source("./R/multiplotF.R")
multiplot(plot_temp_daily, plot_temp_annual, cols = 2)
### save as pdf
pdf("./figs/sc_temp_plot.pdf", width = 7, height = 3.5)
multiplot(plot_temp_annual, plot_temp_daily,cols = 2)
dev.off()
##### TEMPERATURE PLOTS #####
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 1,
size = rel(1.2)))
### Annual temperatures - time-series
plot_temp_annual <- sc_yearly %>% filter(year > 1962 & year < 2010) %>%
ggplot(data = ., aes(year, tempC)) +
geom_point() + geom_smooth() +
ylab(expression(paste("Annual temperature (", degree, "C)"))) +
xlab("") +
ULClabel + labs(title = "A")
### Daily temperatures - era comparison
plot_temp_daily <- ggplot(data = longSC, aes(era, tempSC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily temperature (", degree, "C)"))) +
xlab("") +
ULClabel + labs(title = "B")
### save as pdf
pdf("./figs/sc_temp_plot.pdf", width = 7, height = 3.5)
multiplot(plot_temp_annual, plot_temp_daily,cols = 2)
dev.off()
pastSC %>% summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
presSC %>% summarise(meanTemp = mean(tempSC, na.rm = TRUE),
sdTemp = sd(tempSC, na.rm = TRUE))
sc_meanTemp_past <- pastSC %>% summarise(meanTemp = mean(tempSC, na.rm = TRUE))
sc_meanTemp_pres <- presSC %>% summarise(meanTemp = mean(tempSC, na.rm = TRUE))
head(fadTemp)
hms_meanTemp <- fadTemp %>% summarise(meanTemp = mean(SST, na.rm = TRUE))
sc_meanTemp_pres; sc_meanTemp_past; hms_meanTemp
